import { Button, LineEdit, VerticalBox } from "std-widgets.slint";

export component Sidebar inherits Rectangle {
    // Inputs from parent
    in property <bool> node-is-running;
    in property <string> node-sync-status;
    in property <bool> wallet-needs-unlock;
    
    // Callbacks to parent
    callback manage-channels();
    callback create-channel();
    callback generate-xh();
    callback create-custom-invoice();
    callback pay-invoice();
    callback claim-invoice();
    callback create-standard-invoice();
    callback check-node-status();
    callback start-node();
    callback unlock-wallet(string); // password
    
    width: 220px;
    background: #1a1a1a;
    
    VerticalBox {
        padding: 16px;
        spacing: 12px;
        
        Text {
            text: "Lightning Network";
            font-size: 18px;
            font-weight: 700;
            color: #e0e0e0;
        }
        
        // WALLET UNLOCK SECTION - Move this to the top for visibility
        if root.wallet-needs-unlock: Rectangle {
            height: 140px;
            background: #3a0000; // Deep red background
            border-radius: 6px;
            border-width: 2px;
            border-color: #dc3545;
            
            VerticalLayout {
                padding: 12px;
                spacing: 10px;
                
                Text {
                    text: "⚠️ WALLET LOCKED";
                    font-weight: 700;
                    font-size: 16px;
                    color: #ff6b70;
                    horizontal-alignment: center;
                }
                
                wallet-password := LineEdit {
                    placeholder-text: "Enter wallet password";
                    input-type: InputType.password;
                    height: 36px;
                }
                
                TouchArea {
                    Rectangle {
                        height: 36px;
                        width: 100%;
                        background: #5294e2;
                        border-radius: 4px;
                        
                        Text {
                            text: "UNLOCK WALLET";
                            color: white;
                            font-size: 14px;
                            font-weight: 700;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }
                    clicked => { root.unlock-wallet(wallet-password.text); }
                }
            }
        }
        
        // Node status indicator
        Rectangle {
            height: 80px;
            background: #252525;
            border-radius: 4px;
            
            VerticalLayout {
                padding: 10px;
                spacing: 6px;
                
                HorizontalLayout {
                    spacing: 6px;
                    
                    Rectangle {
                        width: 12px;
                        height: 12px;
                        border-radius: 6px;
                        background: root.node-is-running ? #20c997 : #dc3545;
                    }
                    
                    Text {
                        text: root.node-is-running ? "Node Running" : "Node Offline";
                        color: root.node-is-running ? #e0e0e0 : #ffb0a3;
                        font-weight: 500;
                        vertical-alignment: center;
                    }
                }
                
                Text {
                    text: "Sync: " + root.node-sync-status;
                    color: #bbbbbb;
                    font-size: 13px;
                }
                
                HorizontalLayout {
                    spacing: 8px;
                    
                    if !root.node-is-running: TouchArea {
                        width: 100px;
                        Rectangle {
                            width: 100%;
                            height: 26px;
                            border-radius: 4px;
                            background: #20c997;
                            
                            Text {
                                text: "Start Node";
                                color: black;
                                font-size: 12px;
                                font-weight: 500;
                                horizontal-alignment: center;
                                vertical-alignment: center;
                            }
                        }
                        clicked => { root.start-node(); }
                    }
                    
                    TouchArea {
                        width: 80px;
                        Rectangle {
                            width: 100%;
                            height: 26px;
                            border-radius: 4px;
                            background: #5294e2;
                            
                            Text {
                                text: "Refresh";
                                color: white;
                                font-size: 12px;
                                font-weight: 500;
                                horizontal-alignment: center;
                                vertical-alignment: center;
                            }
                        }
                        clicked => { root.check-node-status(); }
                    }
                }
            }
        }
        
        // Channels section
        Text {
            text: "Channels";
            font-size: 16px;
            font-weight: 600;
            color: #d0d0d0;
        }
        
        Rectangle {
            height: 80px;
            VerticalLayout {
                spacing: 8px;
                
                TouchArea {
                    Rectangle {
                        height: 34px;
                        width: 100%;
                        background: #333333;
                        border-radius: 4px;
                        
                        Text {
                            text: "Manage Channels";
                            color: white;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }
                    clicked => { root.manage-channels(); }
                }
                
                TouchArea {
                    Rectangle {
                        height: 34px;
                        width: 100%;
                        background: #333333;
                        border-radius: 4px;
                        
                        Text {
                            text: "Create Channel";
                            color: white;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }
                    clicked => { root.create-channel(); }
                }
            }
        }
        
        // Invoice section
        Text {
            text: "Payments";
            font-size: 16px;
            font-weight: 600;
            color: #d0d0d0;
        }
        
        Rectangle {
            height: 165px;
            VerticalLayout {
                spacing: 8px;
                
                TouchArea {
                    Rectangle {
                        height: 34px;
                        width: 100%;
                        background: #333333;
                        border-radius: 4px;
                        
                        Text {
                            text: "Generate Preimage/Hash";
                            color: white;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }
                    clicked => { root.generate-xh(); }
                }
                
                TouchArea {
                    Rectangle {
                        height: 34px;
                        width: 100%;
                        background: #333333;
                        border-radius: 4px;
                        
                        Text {
                            text: "Create Custom Invoice";
                            color: white;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }
                    clicked => { root.create-custom-invoice(); }
                }
                
                TouchArea {
                    Rectangle {
                        height: 34px;
                        width: 100%;
                        background: #333333;
                        border-radius: 4px;
                        
                        Text {
                            text: "Pay Invoice";
                            color: white;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }
                    clicked => { root.pay-invoice(); }
                }
                
                TouchArea {
                    Rectangle {
                        height: 34px;
                        width: 100%;
                        background: #333333;
                        border-radius: 4px;
                        
                        Text {
                            text: "Settle With Preimage";
                            color: white;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }
                    clicked => { root.claim-invoice(); }
                }
            }
        }
    }
} 