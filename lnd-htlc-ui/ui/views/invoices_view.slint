import { ScrollView, VerticalBox, StandardListView, Button } from "std-widgets.slint";

export struct InvoiceDetails {
    memo: string,
    r_hash: string,
    value: string,
    state: string,
    creation_date: string,
    is_own_invoice: bool,
}

export component InvoicesView inherits VerticalBox {
    // Callback to signal that invoices should be fetched or refreshed
    callback list-invoices-requested();
    // Property to hold the list of invoices
    in-out property <[InvoiceDetails]> invoices: [];

    Text {
        text: invoices.length + " invoices";
        font-size: 24px;
        font-weight: 700;
        horizontal-alignment: center;
        padding-bottom: 20px;
    }

    ScrollView {
        viewport-height: 400px; // Adjust as needed
        if invoices.length == 0 : VerticalBox {
            Text {
                text: "No invoices found";
                horizontal-alignment: center;
                vertical-alignment: center;
                color: #888;
                font-size: 16px;
            }
        }
        if invoices.length > 0 : VerticalLayout {
            
            for invoice_item in invoices: Rectangle {
                padding: 10px;
                height: 60px;
                background: #2a2a2a;
                border-radius: 8px;

                VerticalLayout {
                    spacing: 12px;
                    padding: 16px;

                    HorizontalLayout {
                        spacing: 16px;

                        VerticalLayout {
                            Text { 
                                text: invoice_item.memo;
                                font-size: 18px;
                                font-weight: 600;
                                color: #ffffff;
                            }

                            HorizontalLayout {
                                spacing: 8px;
                                alignment: start;

                                Rectangle {
                                    width: 12px;
                                    padding: 4px;
                                    height: 12px;
                                    border-radius: 6px;
                                    background: invoice_item.state == "SETTLED" ? #4caf50 : #ffc107;
                                }

                                Text {
                                    text: invoice_item.state;
                                    font-size: 14px;
                                    color: invoice_item.state == "SETTLED" ? #4caf50 : #ffc107;
                                }
                            }
                        }

                        Rectangle {
                            width: 1px;
                            background: #404040;
                        }

                        VerticalLayout {
                            alignment: center;
                            Text {
                                text: invoice_item.value + " sats";
                                font-size: 20px;
                                font-weight: 700;
                                color: #5294e2;
                            }
                            Text {
                                text: invoice_item.creation_date;
                                font-size: 12px;
                                color: #808080;
                            }
                        }
                    }

                    Text {
                        text: "Hash: " + invoice_item.r_hash;
                        font-size: 12px;
                        color: #e4e0e0;
                        opacity: 0.7;
                    }
                }   

                Rectangle {
                    height: 8px;
                }
            }
        }
    }
}
